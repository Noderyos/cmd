<h1>X-Ray</h1>
<h2>Solver : <span style='color:red;'>Noderyos</span></h2>
<p>At first time, the file x-ray seems juste random data (file says <span style='color:red;'>data</span>), but we know he has been "quarantined", after some research, I found <a href='https://reversingfun.com/posts/how-to-extract-quarantine-files-from-windows-defender/'>this article</a> that explain how Windows Defender quarantine files, I stole the key and <span style='color:red;'>rc4_decrypt</span> function from his code to decode the file and the start to remove useless bytes in <span style='color:red;'>unpack.py</span>, and now, file says <span style='color:red;'>PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS Windows, 3 sections</span>, after exploring the code in dnSpy, I found this function in <span style='color:red;'>StageTwo.cs</span> :<br></p><pre><code>cs
private static byte[] otp(byte[] data, byte[] key){
	byte[] array = new byte[data.Length];
	for (int i = 0; i < data.Length; i++){
		array[i] = data[i] ^ key[i % key.Length];
	}
	return array;
}

private static byte[] load(string hex){
	int length = hex.Length;
	byte[] array = new byte[length / 2];
	for (int i = 0; i < length; i += 2){
		array[i / 2] = Convert.ToByte(hex.Substring(i, 2), 16);
	}
	return array;
}

public static void Main(string[] args){
	// ...
	byte[] array = StageTwo.load("15b279d8c0fdbd7d4a8eea255876a0fd189f4fafd4f4124dafae47cb20a447308e3f77995d3c");
	byte[] array2 = StageTwo.load("73de18bfbb99db4f7cbed3156d40959e7aac7d96b29071759c9b70fb18947000be5d41ab6c41");
	byte[] array3 = StageTwo.otp(array, array2);
	Encoding.UTF8.GetString(array3);
}</code></pre>

<p>So I replicated this code in python in <span style='color:red;'>stage2.py</span> then ran the file, giving me the flag.<br><br></p><h2>Flag : <span style='color:red;'>flag{df26090565cb329fdc8357080700b621}</span></h2>